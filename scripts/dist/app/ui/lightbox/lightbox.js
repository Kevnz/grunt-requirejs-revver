define(["jquery","colorbox"],function(e){var t;return{$cboxContent:null,$colorbox:null,$cboxWrapper:null,$cboxClose:null,$cboxTitle:null,$cboxLoadedContent:null,$cboxDescription:null,init:function(){this._setVars(),t=this,e(window).on("resize",function(){e.colorbox.close()})},onLoadProcessing:function(){t._addDescription.call(this)},onCompleteProcessing:function(){t._adjustContent.call(this),t._adjustWindow.call(this)},setTitle:function(){var t=e(this),n=t.data("videoid"),r=t.data("caption");return r==""&&n!=null?(e.getJSON("http://gdata.youtube.com/feeds/api/videos/"+n+"?v=2&alt=jsonc",function(n,i,s){r=jQuery.trim(n.data.description).substring(0,145).split(" ").slice(0,-1).join(" ")+"...",t.find(".youtube-description").attr("alt",r),e("#cboxDescription").text(r)}),r):e(this).nextAll(".js-lightbox-caption").text()},_addDescription:function(){var n=e("#cboxDescription"),r=e(this).find("img").first().attr("alt")||"&nbsp;",i='<p id="cboxDescription">'+r+"</p>";n.length>0?n.html(r):(t.$cboxContent.append(i),n=e("#cboxDescription")),t.$cboxDescription=n},_adjustContent:function(){var n=t.$cboxTitle.outerHeight(),r=e("#cboxLoadedContent");r.css({"margin-top":n}),t.$cboxLoadedContent=e("#cboxLoadedContent")},_adjustWindow:function(){var n=e(this).closest(".js-lightbox-gallery").length,r=t.$cboxLoadedContent.outerHeight(),i=t.$cboxTitle.outerHeight(),s=t.$cboxDescription.text(),o=!e.trim(s).length&&!n?0:t.$cboxDescription.outerHeight(!0),u=r+i+o,a=t.$colorbox.height(),f=t.$colorbox.css("top"),l=(u-a)/2,c=parseFloat(f)-l;t.$colorbox.height(u),t.$cboxWrapper.height(u),t.$colorbox.css({top:String(c)+"px"})},_setVars:function(){this.$cboxContent=this.$cboxContent||e("#cboxContent"),this.$colorbox=this.$colorbox||e("#colorbox"),this.$cboxWrapper=this.$cboxWrapper||e("#cboxWrapper"),this.$cboxClose=this.$cboxClose||e("#cboxClose"),this.$cboxTitle=this.$cboxTitle||e("#cboxTitle")}}});
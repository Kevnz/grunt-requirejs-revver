define(["jquery","app/ui/mediaqueries/mediaqueries","pubsub"],function(e,t){var n;return{openVideoInLightbox:!1,init:function(){n||this._initSubscriptions(),n=n||this;var t=e(".js-lightbox-load");e(".js-lightbox-load").length&&(t.find(".figure-caption").on("click",this._triggerMainImage),t.find(".js-lightbox-image").one("click",this._loadAssets))},_initSubscriptions:function(){e.subscribe("/lightbox/init",e.proxy(this.init,this))},_loadAssets:function(t){t.preventDefault();var r=e(this);n._loadCompleted.call(r[0])},_triggerMainImage:function(t){t.preventDefault(),e(this).prevAll(".js-lightbox-image").trigger("click")},_initImageLightboxes:function(){e(".js-lightbox-single").length&&require(["app/ui/lightbox/single"],function(e){e.init()}),e(".js-lightbox-gallery").length&&require(["app/ui/lightbox/gallery"],function(e){e.init()}),e(".js-lightbox-video").length&&t.register({queries:t.queries["extra-large"],shouldDegrade:!0,match:function(){require(["app/ui/lightbox/gallery"],function(e){this.openVideoInLightbox=!0,e.init()})},unmatch:function(){require(["app/ui/lightbox/gallery"],function(e){this.openVideoInLightbox=!1})}})},_loadCompleted:function(){var t=e(this),r=t.closest("div"),i="app/ui/lightbox/single";n._removeLoadEvents(),r.is(".js-lightbox-video")?i="app/ui/lightbox/video":r.is(".js-lightbox-gallery")&&(i="app/ui/lightbox/gallery"),require(["app/ui/lightbox/lightbox",i],function(e,r){e.init(),n._initImageLightboxes(),i!=="Video"||n.openVideoInLightbox===!0?(r.init(),r.open.call(t[0])):window.location.href=t.attr("href")})},_removeLoadEvents:function(){e(".js-lightbox-load").removeClass("js-lightbox-load")}}});
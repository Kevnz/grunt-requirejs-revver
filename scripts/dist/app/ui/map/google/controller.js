function MarkerManager(e,t){var n=this;n.map_=e,n.mapZoom_=e.getZoom(),n.projection_=e.getCurrentMapType().getProjection(),t=t||{},n.tileSize_=MarkerManager.DEFAULT_TILE_SIZE_;var r=MarkerManager.DEFAULT_MAX_ZOOM_;t.maxZoom!=undefined&&(r=t.maxZoom),n.maxZoom_=r,n.trackMarkers_=t.trackMarkers;var i;typeof t.borderPadding=="number"?i=t.borderPadding:i=MarkerManager.DEFAULT_BORDER_PADDING_,n.swPadding_=new google.maps.Size(-i,i),n.nePadding_=new google.maps.Size(i,-i),n.borderPadding_=i,n.gridWidth_=[],n.grid_=[],n.grid_[r]=[],n.numMarkers_=[],n.numMarkers_[r]=0,google.maps.Event.bind(e,"moveend",n,n.onMapMoveEnd_),n.removeOverlay_=function(t){e.removeOverlay(t),n.shownMarkers_--},n.addOverlay_=function(t){e.addOverlay(t),n.shownMarkers_++},n.resetManager_(),n.shownMarkers_=0,n.shownBounds_=n.getMapGridBounds_()}(function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,i,s=e(this[0]);s.length&&s[0]!==document;){if(r=s.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(s.css("zIndex"),10),!isNaN(i)&&0!==i))return i;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(i&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;i.length>r;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})})(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n,r=0;null!=(n=t[r]);r++)try{e(n).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(n,r,i){var s,o,u,a,f={},l=n.split(".")[0];n=n.split(".")[1],s=l+"-"+n,i||(i=r,r=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[l]=e[l]||{},o=e[l][n],u=e[l][n]=function(e,n){return this._createWidget?(arguments.length&&this._createWidget(e,n),t):new u(e,n)},e.extend(u,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new r,a.options=e.widget.extend({},a.options),e.each(i,function(n,i){return e.isFunction(i)?(f[n]=function(){var e=function(){return r.prototype[n].apply(this,arguments)},t=function(e){return r.prototype[n].apply(this,e)};return function(){var n,r=this._super,s=this._superApply;return this._super=e,this._superApply=t,n=i.apply(this,arguments),this._super=r,this._superApply=s,n}}(),t):(f[n]=i,t)}),u.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix:n},f,{constructor:u,namespace:l,widgetName:n,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,u,n._proto)}),delete o._childConstructors):r._childConstructors.push(u),e.widget.bridge(n,u)},e.widget.extend=function(n){for(var i,o,u=r.call(arguments,1),a=0,f=u.length;f>a;a++)for(i in u[a])o=u[a][i],u[a].hasOwnProperty(i)&&o!==t&&(n[i]=e.isPlainObject(o)?e.isPlainObject(n[i])?e.widget.extend({},n[i],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,i){var o=i.prototype.widgetFullName||n;e.fn[n]=function(u){var f="string"==typeof u,l=r.call(arguments,1),c=this;return u=!f&&l.length?e.widget.extend.apply(null,[u].concat(l)):u,f?this.each(function(){var r,i=e.data(this,o);return i?e.isFunction(i[u])&&"_"!==u.charAt(0)?(r=i[u].apply(i,l),r!==i&&r!==t?(c=r&&r.jquery?c.pushStack(r.get()):r,!1):t):e.error("no such method '"+u+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+u+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(u||{})._init():e.data(this,o,new i(u,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(u={},i=n.split("."),n=i.shift(),i.length){for(s=u[n]=e.widget.extend({},this.options[n]),o=0;i.length-1>o;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(n=i.pop(),r===t)return s[n]===t?null:s[n];s[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];u[n]=r}return this._setOptions(u),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(n,r,i){var s,o=this;"boolean"!=typeof n&&(i=r,r=n,n=!1),i?(r=s=e(r),this.bindings=this.bindings.add(r)):(i=r,r=this.element,s=this.widget()),e.each(i,function(i,u){function f(){return n||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof u?o[u]:u).apply(o,arguments):t}"string"!=typeof u&&(f.guid=u.guid=u.guid||f.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,h=l[2];h?s.delegate(h,c,f):r.bind(c,f)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,s="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return i&&!s&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function n(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function r(t,n){return parseInt(e.css(t,n),10)||0}function i(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,o=Math.max,u=Math.abs,a=Math.round,f=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var n,r,i=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=i.children()[0];return e("body").append(i),n=o.offsetWidth,i.css("overflow","scroll"),r=o.offsetWidth,n===r&&(r=i[0].clientWidth),i.remove(),s=n-r},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=e.extend({},t);var s,p,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=i(b),b[0].preventDefault&&(t.at="left top"),p=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e,n,r=(t[this]||"").split(" ");1===r.length&&(r=f.test(r[0])?r.concat(["center"]):l.test(r[0])?["center"].concat(r):["center","center"]),r[0]=f.test(r[0])?r[0]:"center",r[1]=l.test(r[1])?r[1]:"center",e=c.exec(r[0]),n=c.exec(r[1]),x[this]=[e?e[0]:0,n?n[0]:0],t[this]=[h.exec(r[0])[0],h.exec(r[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===t.at[0]?g.left+=p:"center"===t.at[0]&&(g.left+=p/2),"bottom"===t.at[1]?g.top+=v:"center"===t.at[1]&&(g.top+=v/2),s=n(x.at,p,v),g.left+=s[0],g.top+=s[1],this.each(function(){var i,f,l=e(this),c=l.outerWidth(),h=l.outerHeight(),d=r(this,"marginLeft"),y=r(this,"marginTop"),T=c+d+r(this,"marginRight")+E.width,N=h+y+r(this,"marginBottom")+E.height,C=e.extend({},g),L=n(x.my,l.outerWidth(),l.outerHeight());"right"===t.my[0]?C.left-=c:"center"===t.my[0]&&(C.left-=c/2),"bottom"===t.my[1]?C.top-=h:"center"===t.my[1]&&(C.top-=h/2),C.left+=L[0],C.top+=L[1],e.support.offsetFractions||(C.left=a(C.left),C.top=a(C.top)),i={marginLeft:d,marginTop:y},e.each(["left","top"],function(n,r){e.ui.position[S[n]]&&e.ui.position[S[n]][r](C,{targetWidth:p,targetHeight:v,elemWidth:c,elemHeight:h,collisionPosition:i,collisionWidth:T,collisionHeight:N,offset:[s[0]+L[0],s[1]+L[1]],my:t.my,at:t.at,within:w,elem:l})}),t.using&&(f=function(e){var n=m.left-C.left,r=n+p-c,i=m.top-C.top,s=i+v-h,a={target:{element:b,left:m.left,top:m.top,width:p,height:v},element:{element:l,left:C.left,top:C.top,width:c,height:h},horizontal:0>r?"left":n>0?"right":"center",vertical:0>s?"top":i>0?"bottom":"middle"};c>p&&p>u(n+r)&&(a.horizontal="center"),h>v&&v>u(i+s)&&(a.vertical="middle"),a.important=o(u(n),u(r))>o(u(i),u(s))?"horizontal":"vertical",t.using.call(this,e,a)}),l.offset(e.extend(C,{using:f}))})},e.ui.position={fit:{left:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollLeft:r.offset.left,s=r.width,u=e.left-t.collisionPosition.marginLeft,a=i-u,f=u+t.collisionWidth-s-i;t.collisionWidth>s?a>0&&0>=f?(n=e.left+a+t.collisionWidth-s-i,e.left+=a-n):e.left=f>0&&0>=a?i:a>f?i+s-t.collisionWidth:i:a>0?e.left+=a:f>0?e.left-=f:e.left=o(e.left-u,e.left)},top:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollTop:r.offset.top,s=t.within.height,u=e.top-t.collisionPosition.marginTop,a=i-u,f=u+t.collisionHeight-s-i;t.collisionHeight>s?a>0&&0>=f?(n=e.top+a+t.collisionHeight-s-i,e.top+=a-n):e.top=f>0&&0>=a?i:a>f?i+s-t.collisionHeight:i:a>0?e.top+=a:f>0?e.top-=f:e.top=o(e.top-u,e.top)}},flip:{left:function(e,t){var n,r,i=t.within,s=i.offset.left+i.scrollLeft,o=i.width,a=i.isWindow?i.scrollLeft:i.offset.left,f=e.left-t.collisionPosition.marginLeft,l=f-a,c=f+t.collisionWidth-o-a,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,d=-2*t.offset[0];0>l?(n=e.left+h+p+d+t.collisionWidth-o-s,(0>n||u(l)>n)&&(e.left+=h+p+d)):c>0&&(r=e.left-t.collisionPosition.marginLeft+h+p+d-a,(r>0||c>u(r))&&(e.left+=h+p+d))},top:function(e,t){var n,r,i=t.within,s=i.offset.top+i.scrollTop,o=i.height,a=i.isWindow?i.scrollTop:i.offset.top,f=e.top-t.collisionPosition.marginTop,l=f-a,c=f+t.collisionHeight-o-a,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,d="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,v=-2*t.offset[1];0>l?(r=e.top+p+d+v+t.collisionHeight-o-s,e.top+p+d+v>l&&(0>r||u(l)>r)&&(e.top+=p+d+v)):c>0&&(n=e.top-t.collisionPosition.marginTop+p+d+v-a,e.top+p+d+v>c&&(n>0||c>u(n))&&(e.top+=p+d+v))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&11>i,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n,r=this,i=!1,s=!1;for(e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),n=this.element[0];n&&(n=n.parentNode);)n===document&&(i=!0);return i||"original"!==this.options.helper?("invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;if("parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=["document"===i.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"===i.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"===i.containment?0:e(window).scrollLeft())+e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"===i.containment?0:e(window).scrollTop())+(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||i.containment.constructor===Array)i.containment.constructor===Array&&(this.containment=i.containment);else{if(n=e(i.containment),r=n[0],!r)return;t="hidden"!==e(r).css("overflow"),this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderRightWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderBottomWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName),f=t.pageX,l=t.pageY;return this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(f=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(f=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,f=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var o=!1,u=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==u&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(u.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed)))),i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--)u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height,m>u-v&&a+v>m&&y>f-v&&l+v>y||m>u-v&&a+v>m&&b>f-v&&l+v>b||g>u-v&&a+v>g&&y>f-v&&l+v>y||g>u-v&&a+v>g&&b>f-v&&l+v>b?("inner"!==d.snapMode&&(r=v>=Math.abs(f-b),i=v>=Math.abs(l-y),s=v>=Math.abs(u-g),o=v>=Math.abs(a-m),r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,"outer"!==d.snapMode&&(r=v>=Math.abs(f-y),i=v>=Math.abs(l-b),s=v>=Math.abs(u-m),o=v>=Math.abs(a-g),r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h):(p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});r.length&&(t=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n)),t=i.length;n>t;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))&&(i=n,s=e(this),o=t)}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>r||1===t&&r>n)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),undefined):this._value()},values:function(t,n){var r,i,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t),undefined;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(r=this.options.values,i=arguments[0],s=0;r.length>s;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;switch("range"===t&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;i>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),r=0;n.length>r;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return 2*Math.abs(n)>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=100*((a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())),l["horizontal"===a.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&("horizontal"===a.orientation?(0===r&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(0===r&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?100*((r-i)/(s-i)):0,l["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),"max"===o&&"horizontal"===this.orientation&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),"max"===o&&"vertical"===this.orientation&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(n){var r,i,s,o,u=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(n.target).addClass("ui-state-active"),r=this._start(n,u),r===!1))return}switch(o=this.options.step,i=s=this.options.values&&this.options.values.length?this.values(u):this.value(),n.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(n,u,s)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),define("jqueryui",["jquery"],function(e){return function(){var t,n;return t||e.jQuery}}(this)),MarkerManager.DEFAULT_TILE_SIZE_=1024,MarkerManager.DEFAULT_MAX_ZOOM_=17,MarkerManager.DEFAULT_BORDER_PADDING_=100,MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE=256,MarkerManager.prototype.resetManager_=function(){var e=this,t=MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE;for(var n=0;n<=e.maxZoom_;++n)e.grid_[n]=[],e.numMarkers_[n]=0,e.gridWidth_[n]=Math.ceil(t/e.tileSize_),t<<=1},MarkerManager.prototype.clearMarkers=function(){var e=this;e.processAll_(e.shownBounds_,e.removeOverlay_),e.resetManager_()},MarkerManager.prototype.getTilePoint_=function(e,t,n){var r=this.projection_.fromLatLngToPixel(e,t);return new google.maps.Point(Math.floor((r.x+n.width)/this.tileSize_),Math.floor((r.y+n.height)/this.tileSize_))},MarkerManager.prototype.addMarkerBatch_=function(e,t,n){var r=e.getPoint();this.trackMarkers_&&google.maps.Event.bind(e,"changed",this,this.onMarkerMoved_);var i=this.getTilePoint_(r,n,google.maps.Size.ZERO);for(var s=n;s>=t;s--){var o=this.getGridCellCreate_(i.x,i.y,s);o.push(e),i.x=i.x>>1,i.y=i.y>>1}},MarkerManager.prototype.isGridPointVisible_=function(e){var t=this,n=t.shownBounds_.minY<=e.y&&e.y<=t.shownBounds_.maxY,r=t.shownBounds_.minX,i=r<=e.x&&e.x<=t.shownBounds_.maxX;if(!i&&r<0){var s=t.gridWidth_[t.shownBounds_.z];i=r+s<=e.x&&e.x<=s-1}return n&&i},MarkerManager.prototype.onMarkerMoved_=function(e,t,n){var r=this,i=r.maxZoom_,s=!1,o=r.getTilePoint_(t,i,google.maps.Size.ZERO),u=r.getTilePoint_(n,i,google.maps.Size.ZERO);while(i>=0&&(o.x!=u.x||o.y!=u.y)){var a=r.getGridCellNoCreate_(o.x,o.y,i);a&&r.removeFromArray(a,e)&&r.getGridCellCreate_(u.x,u.y,i).push(e),i==r.mapZoom_&&(r.isGridPointVisible_(o)?r.isGridPointVisible_(u)||(r.removeOverlay_(e),s=!0):r.isGridPointVisible_(u)&&(r.addOverlay_(e),s=!0)),o.x=o.x>>1,o.y=o.y>>1,u.x=u.x>>1,u.y=u.y>>1,--i}s&&r.notifyListeners_()},MarkerManager.prototype.removeMarker=function(e){var t=this,n=t.maxZoom_,r=!1,i=e.getPoint(),s=t.getTilePoint_(i,n,google.maps.Size.ZERO);while(n>=0){var o=t.getGridCellNoCreate_(s.x,s.y,n);o&&t.removeFromArray(o,e),n==t.mapZoom_&&t.isGridPointVisible_(s)&&(t.removeOverlay_(e),r=!0),s.x=s.x>>1,s.y=s.y>>1,--n}r&&t.notifyListeners_()},MarkerManager.prototype.addMarkers=function(e,t,n){var r=this.getOptMaxZoom_(n);for(var i=e.length-1;i>=0;i--)this.addMarkerBatch_(e[i],t,r);this.numMarkers_[t]+=e.length},MarkerManager.prototype.getOptMaxZoom_=function(e){return e!=undefined?e:this.maxZoom_},MarkerManager.prototype.getMarkerCount=function(e){var t=0;for(var n=0;n<=e;n++)t+=this.numMarkers_[n];return t},MarkerManager.prototype.addMarker=function(e,t,n){var r=this,i=this.getOptMaxZoom_(n);r.addMarkerBatch_(e,t,i);var s=r.getTilePoint_(e.getPoint(),r.mapZoom_,google.maps.Size.ZERO);r.isGridPointVisible_(s)&&t<=r.shownBounds_.z&&r.shownBounds_.z<=i&&(r.addOverlay_(e),r.notifyListeners_()),this.numMarkers_[t]++},google.maps.Bounds.prototype.containsPoint=function(e){var t=this;return t.minX<=e.x&&t.maxX>=e.x&&t.minY<=e.y&&t.maxY>=e.y},MarkerManager.prototype.getGridCellCreate_=function(e,t,n){var r=this.grid_[n];e<0&&(e+=this.gridWidth_[n]);var i=r[e];if(!i)return i=r[e]=[],i[t]=[];var s=i[t];return s?s:i[t]=[]},MarkerManager.prototype.getGridCellNoCreate_=function(e,t,n){var r=this.grid_[n];e<0&&(e+=this.gridWidth_[n]);var i=r[e];return i?i[t]:undefined},MarkerManager.prototype.getGridBounds_=function(e,t,n,r){t=Math.min(t,this.maxZoom_);var i=e.getSouthWest(),s=e.getNorthEast(),o=this.getTilePoint_(i,t,n),u=this.getTilePoint_(s,t,r),a=this.gridWidth_[t];if(s.lng()<i.lng()||u.x<o.x)o.x-=a;u.x-o.x+1>=a&&(o.x=0,u.x=a-1);var f=new google.maps.Bounds([o,u]);return f.z=t,f},MarkerManager.prototype.getMapGridBounds_=function(){var e=this;return e.getGridBounds_(e.map_.getBounds(),e.mapZoom_,e.swPadding_,e.nePadding_)},MarkerManager.prototype.onMapMoveEnd_=function(){var e=this;e.objectSetTimeout_(this,this.updateMarkers_,0)},MarkerManager.prototype.objectSetTimeout_=function(e,t,n){return window.setTimeout(function(){t.call(e)},n)},MarkerManager.prototype.refresh=function(){var e=this;e.shownMarkers_>0&&e.processAll_(e.shownBounds_,e.removeOverlay_),e.processAll_(e.shownBounds_,e.addOverlay_),e.notifyListeners_()},MarkerManager.prototype.updateMarkers_=function(){var e=this;e.mapZoom_=this.map_.getZoom();var t=e.getMapGridBounds_();if(t.equals(e.shownBounds_)&&t.z==e.shownBounds_.z)return;t.z!=e.shownBounds_.z?(e.processAll_(e.shownBounds_,e.removeOverlay_),e.processAll_(t,e.addOverlay_)):(e.rectangleDiff_(e.shownBounds_,t,e.removeCellMarkers_),e.rectangleDiff_(t,e.shownBounds_,e.addCellMarkers_)),e.shownBounds_=t,e.notifyListeners_()},MarkerManager.prototype.notifyListeners_=function(){google.maps.Event.trigger(this,"changed",this.shownBounds_,this.shownMarkers_)},MarkerManager.prototype.processAll_=function(e,t){for(var n=e.minX;n<=e.maxX;n++)for(var r=e.minY;r<=e.maxY;r++)this.processCellMarkers_(n,r,e.z,t)},MarkerManager.prototype.processCellMarkers_=function(e,t,n,r){var i=this.getGridCellNoCreate_(e,t,n);if(i)for(var s=i.length-1;s>=0;s--)r(i[s])},MarkerManager.prototype.removeCellMarkers_=function(e,t,n){this.processCellMarkers_(e,t,n,this.removeOverlay_)},MarkerManager.prototype.addCellMarkers_=function(e,t,n){this.processCellMarkers_(e,t,n,this.addOverlay_)},MarkerManager.prototype.rectangleDiff_=function(e,t,n){var r=this;r.rectangleDiffCoords(e,t,function(t,i){n.apply(r,[t,i,e.z])})},MarkerManager.prototype.rectangleDiffCoords=function(e,t,n){var r=e.minX,i=e.minY,s=e.maxX,o=e.maxY,u=t.minX,a=t.minY,f=t.maxX,l=t.maxY;for(var c=r;c<=s;c++){for(var h=i;h<=o&&h<a;h++)n(c,h);for(var h=Math.max(l+1,i);h<=o;h++)n(c,h)}for(var h=Math.max(i,a);h<=Math.min(o,l);h++){for(var c=Math.min(s+1,u)-1;c>=r;c--)n(c,h);for(var c=Math.max(r,f+1);c<=s;c++)n(c,h)}},MarkerManager.prototype.removeFromArray=function(e,t,n){var r=0;for(var i=0;i<e.length;++i)if(e[i]===t||n&&e[i]==t)e.splice(i--,1),r++;return r},define("app/ui/map/google/markermanager",function(){});var globalMap=null;define("app/ui/map/google/gmap",["jquery","jqueryui","app/ui/map/google/markermanager"],function($){function ShowRedZone(e){var t=[new GLatLng(-43.529991,172.634323),new GLatLng(-43.53006,172.634247),new GLatLng(-43.530041,172.634171),new GLatLng(-43.530602,172.633484),new GLatLng(-43.530762,172.633453),new GLatLng(-43.530861,172.633438),new GLatLng(-43.530941,172.633255),new GLatLng(-43.53101,172.633255),new GLatLng(-43.53133,172.633301),new GLatLng(-43.531891,172.633713),new GLatLng(-43.531891,172.633896),new GLatLng(-43.531971,172.633896),new GLatLng(-43.531971,172.635193),new GLatLng(-43.531712,172.635193),new GLatLng(-43.531712,172.635773),new GLatLng(-43.532471,172.635773),new GLatLng(-43.532471,172.636536),new GLatLng(-43.534191,172.636566),new GLatLng(-43.534302,172.636703),new GLatLng(-43.535061,172.636703),new GLatLng(-43.535061,172.636963),new GLatLng(-43.53532,172.636963),new GLatLng(-43.535271,172.639664),new GLatLng(-43.535061,172.639664),new GLatLng(-43.53508,172.640137),new GLatLng(-43.534821,172.640427),new GLatLng(-43.535091,172.640793),new GLatLng(-43.535061,172.640884),new GLatLng(-43.535252,172.641068),new GLatLng(-43.535252,172.642563),new GLatLng(-43.533051,172.642548),new GLatLng(-43.53307,172.642136),new GLatLng(-43.53315,172.642136),new GLatLng(-43.533131,172.640656),new GLatLng(-43.532021,172.64064),new GLatLng(-43.532021,172.641953),new GLatLng(-43.530972,172.641953),new GLatLng(-43.530972,172.639771),new GLatLng(-43.530861,172.639542),new GLatLng(-43.530861,172.639175),new GLatLng(-43.530621,172.639175),new GLatLng(-43.530621,172.638504),new GLatLng(-43.530861,172.638504),new GLatLng(-43.530861,172.638016),new GLatLng(-43.52993,172.638),new GLatLng(-43.52993,172.636703),new GLatLng(-43.530209,172.636703),new GLatLng(-43.530209,172.636581),new GLatLng(-43.529938,172.636581),new GLatLng(-43.529911,172.634476),new GLatLng(-43.529991,172.634323)],n=[new GLatLng(-43.529812,172.636703),new GLatLng(-43.529812,172.638016),new GLatLng(-43.529861,172.638016),new GLatLng(-43.529854,172.638657),new GLatLng(-43.529781,172.638641),new GLatLng(-43.529789,172.639557),new GLatLng(-43.528812,172.639542),new GLatLng(-43.527557,172.639542),new GLatLng(-43.527561,172.639252),new GLatLng(-43.526791,172.639252),new GLatLng(-43.526791,172.639557),new GLatLng(-43.525532,172.639526),new GLatLng(-43.525551,172.637024),new GLatLng(-43.525791,172.637054),new GLatLng(-43.52581,172.636703),new GLatLng(-43.526501,172.636688),new GLatLng(-43.526505,172.636505),new GLatLng(-43.526505,172.636215),new GLatLng(-43.526043,172.63623),new GLatLng(-43.526039,172.636002),new GLatLng(-43.525543,172.635971),new GLatLng(-43.525555,172.635239),new GLatLng(-43.526485,172.635239),new GLatLng(-43.526485,172.634933),new GLatLng(-43.526657,172.634949),new GLatLng(-43.526661,172.634674),new GLatLng(-43.527309,172.634689),new GLatLng(-43.527325,172.635208),new GLatLng(-43.527702,172.635223),new GLatLng(-43.52779,172.635345),new GLatLng(-43.527668,172.635666),new GLatLng(-43.527588,172.635971),new GLatLng(-43.527405,172.636368),new GLatLng(-43.527191,172.636536),new GLatLng(-43.528717,172.636536),new GLatLng(-43.528725,172.63591),new GLatLng(-43.528507,172.63591),new GLatLng(-43.528515,172.635422),new GLatLng(-43.52874,172.635406),new GLatLng(-43.528744,172.635025),new GLatLng(-43.528847,172.634949),new GLatLng(-43.528843,172.634781),new GLatLng(-43.529202,172.63472),new GLatLng(-43.529503,172.634521),new GLatLng(-43.5298,172.634247),new GLatLng(-43.529812,172.634338),new GLatLng(-43.529648,172.634506),new GLatLng(-43.529671,172.634583),new GLatLng(-43.529789,172.634659),new GLatLng(-43.529812,172.63652),new GLatLng(-43.529655,172.63652),new GLatLng(-43.529655,172.636703),new GLatLng(-43.529812,172.636703)],r=new GPolygon(t,"#ff0000",2,.7,"#ff0000",.35),i=new GPolygon(n,"#ff0000",2,.7,"#ff0000",.35);e.addOverlay(r),e.addOverlay(i)}function ShowAllCategories(e){var t=new Array,n=0;$(".g-map-container .category input:checked").each(function(){t[n]=$(this).val(),n++}),ShowMarkers(e,t)}function ShowOnly(e){var t=FindMap(),n=[];for(var r=0;r<t.data.locations.length;r++)if(t.data.locations[r].id==e){AddMarkerToArray(n,t,t.data.locations[r]);break}n.length>0&&($(".g-map-container .category input").each(function(){this.checked=!1}),ShowMarkers(FindMap(null),[]),t.markerManager||(t.markerManager=new MarkerManager(t)),t.markerManager.clearMarkers(),t.markerManager.addMarkers(n,0,17),t.markerManager.refresh(),DoMarkerClick(t,n[0]))}function ShowMarkers(e,t){e.markerManager||(e.markerManager=new MarkerManager(e)),e.markerManager.clearMarkers();var n=[];for(var r=0;r<e.data.locations.length;r++){var i=-1;for(var s=0;s<e.data.locations[r].categories.length;s++)for(var o=0;o<t.length;o++)t[o]==e.data.locations[r].categories[s]&&(i=t[o]);i>-1&&AddMarkerToArray(n,e,e.data.locations[r])}e.markerManager.addMarkers(n,0,17),e.markerManager.refresh()}function AddMarkerToArray(e,t,n){var r=n.membershipType=="platinum",i=new google.maps.LatLng(n.lat,n.lng),s=new google.maps.Icon(baseIcon),o=t.data.categories[n.markerCategory];s.image="/images/interface/map/markers/"+o.cssClass+".png";var u=new google.maps.Marker(i,s);u.data=n,u.cssClass=o.cssClass,u.imageLo="/images/Interface/map/markers/"+o.cssClass+".png",u.imageHi="/images/Interface/map/markers/"+o.cssClass+".png",google.maps.Event.addListener(u,"mouseover",function(){u.setImage(u.imageHi)}),google.maps.Event.addListener(u,"mouseout",function(){$(".g-map-info.marker-"+u.data.id).length==0&&u.setImage(u.imageLo)}),google.maps.Event.addListener(u,"click",function(){DoMarkerClick(t,u)}),e.push(u)}function DoMarkerClick(e,t){t.setImage(t.imageHi),$(".g-map-info").length==0&&$(e.getContainer()).append("<div class='g-map-info'></div>"),$(".g-map-info").data.marker=t,$(".g-map-info").attr("class","g-map-info width-wrap loading marker-"+t.data.id+" "+t.cssClass).html('<p class="g-map-info-loader">loading...</p>'),$(".g-map-info").fadeIn(),$.ajax({url:"/"+t.data.id+"?altTemplate=InfoPane",dataType:"html",success:function(e){$(".g-map-info").removeClass("loading").html(e),$(".g-map-info .inner").height()>300&&($(".g-map-info .inner").html('<div class="overflow-catcher">'+$(".g-map-info .inner").html()+"</div>"),$(".g-map-info .inner").css({padding:"35px 5px 5px 20px"}))},error:function(e,t,n){$(".g-map-info").html("<div class='inner'><h2>Sorry, There was a problem loading this info.</h2><p>"+t+"</p></div>")}}),e.panTo(new google.maps.LatLng(t.data.lat,t.data.lng))}function CreateGMap(e){if(google.maps.BrowserIsCompatible()){var t=new google.maps.Map2(e);DefaultView(t),t.enableScrollWheelZoom(),t.setMapType(G_NORMAL_MAP),AddCustomMapTypeButtons(t);var n=new google.maps.OverviewMapControl(new google.maps.Size(130,200));return t.addControl(n),AddCustomNavigation(t),$(".g-map-container div:not(.g-map-info)").mousedown(function(){ClearSelection(t)}),$(".g-map-container").on("mousedown",".category",function(){ClearSelection(t)}),$(".g-map-container").on("click",".g-map-info-close",function(){ClearSelection(t)}),google.maps.Event.addListener(t,"zoomend",function(e,n){ClearSelection(t)}),$.publish("/googlemap/resize-container"),t}}function ClearSelection(e){if($(".g-map-info").length>0){var t=$(".g-map-info").data.marker;t.setImage(t.imageLo),$(".g-map-info").remove()}}function AddCustomMapTypeButtons(e){$(e.getContainer()).append("<div class='width-wrap'><div class='type'><a class='map selected pod-heading' title='map'>Map</a><a class='satellite pod-heading' title='satelite'>Satellite</a><a class='terrain pod-heading' title='terrain'>Terrain</a></div></div>"),$(".g-map-container .type .map").click(function(){e.setMapType(G_NORMAL_MAP),$(this).addClass("selected").siblings().removeClass("selected")}),$(".g-map-container .type .terrain").click(function(){e.setMapType(G_PHYSICAL_MAP),$(this).addClass("selected").siblings().removeClass("selected")}),$(".g-map-container .type .satellite").click(function(){e.setMapType(G_SATELLITE_MAP),$(this).addClass("selected").siblings().removeClass("selected")});var t=new google.maps.ControlPosition(G_ANCHOR_TOP_RIGHT,new GSize(0,7));t.apply($(".g-map-container .type")[0])}function AddCategoriesNavigation(e){$(".g-map-container .category").remove(),$(e.getContainer()).append("<div class='width-wrap'><div class='category'><h4><div class='toggle' title='Show/Hide Categories' />Show on the map</h4><div class='body'></div></div></div>"),$(".g-map-container .category .toggle").click(function(){$(this).toggleClass("closed"),$(this).parent().toggleClass("closed"),$(".category .body").slideToggle()});var t=0,n,r={};for(var i=0;i<e.data.categories.length;i++)r[e.data.categories[i].id]=e.data.categories[i].id;for(var i=0;i<e.data.categories.length;i++){var s,o=$(".g-map-container").data("showOneCategory","");e.data.categories[i].level==1&&(e.data.categories[i].showCategory||e.data.categories[i].name=="Miscelaneous"?o!=undefined&&o!=null&&o!=""&&o in r?(n=o==e.data.categories[i].id?'checked="checked"':"",$(".g-map-container").data("showOneCategory",o)):n='checked="checked"':n="",t=i),e.data.categories[i].showCategory?CssClass=e.data.categories[i].cssClass:CssClass="hidden",$(".g-map-container .category .body").append('<label class="png '+CssClass+"\"><input type='checkbox' value='"+i+"' "+n+' rel="'+(t!=i?t:"")+'" /><span class="iconf-'+CssClass+'"></span>'+e.data.categories[i].name+"</label>")}$(".g-map-container .reload-markers").click(function(){google.maps.DownloadUrl("/scripts/src/app/ui/map/google/LocationList.json.aspx",ProcessJson)}),$(".g-map-container .category input").click(function(){var t=$(this).get(0).checked;$(".g-map-container .category input[rel="+$(this).val()+"]").each(function(){this.checked=t}),categoryChanged(e)})}function categoryChanged(e){var t=new Array,n=0;$(".g-map-container .category input:checked").each(function(){t[n]=$(this).val(),n++}),ShowMarkers(e,t)}function AddCustomNavigation(e){$(e.getContainer()).append("<div class='width-wrap'><div class='nav'><div class='pan'><a class='north'></a><a class='west'></a><a class='centre'></a><a class='east'></a><a class='south'></a></div><div class='zoom'><a class='in'></a><div class='slider'></div><a class='out'></a></div></div></div>"),$(".g-map-container .pan .north").click(function(){e.panDirection(0,1)}),$(".g-map-container .pan .west").click(function(){e.panDirection(1,0)}),$(".g-map-container .pan .centre").click(function(){e.returnToSavedPosition()}),$(".g-map-container .pan .east").click(function(){e.panDirection(-1,0)}),$(".g-map-container .pan .south").click(function(){e.panDirection(0,-1)}),$(".g-map-container .zoom .in").click(function(){e.zoomIn()}),$(".g-map-container .zoom .out").click(function(){e.zoomOut()});var t=e.getZoom();$(".g-map-container .zoom .slider").slider({orientation:"vertical",handle:".ui-slider-handle",value:t,min:0,max:17,step:1,slide:function(t,n){e.setZoom(n.value)}}),$(".g-map-container .zoom .slider").slider("value",t),google.maps.Event.addListener(e,"zoomend",function(e,t){$(".zoom .slider").slider("value",t)})}function DefaultView(e){e.setCenter(new google.maps.LatLng(-43.53164036353273,172.63667106628418),8)}function SetBaseIcon(){baseIcon=new google.maps.Icon,baseIcon.shadow="/images/interface/map/shadow.png",baseIcon.iconSize=new google.maps.Size(29,28),baseIcon.shadowSize=new google.maps.Size(52,28),baseIcon.iconAnchor=new google.maps.Point(14,28),baseIcon.infoWindowAnchor=new google.maps.Point(9,2),baseIcon.infoShadowAnchor=new google.maps.Point(18,25)}function FindMap(e){return globalMap}var $gmapContainer,mapLoaded=!1,module;return ProcessJson=function(doc){var theMap=FindMap($gmapContainer[0]),jsonData=eval("("+doc+")");theMap.data=jsonData,DefaultView(theMap),AddCategoriesNavigation(theMap),ShowAllCategories(theMap)},{init:function(){$gmapContainer=$(".g-map-container"),this._initSubscriptions(),module=this},_initSubscriptions:function(){$.subscribe("/googlemap/toggle-complete",this._loadMap),$.subscribe("/googlemap/resize-map",this._resizeMap)},_loadMap:function(e){var t=e.ref;if(!mapLoaded){module._createMap(t);return}t!==0&&ShowOnly(t),$.publish("/googlemap/resize")},_createMap:function(e){SetBaseIcon(),$gmapContainer.each(function(){globalMap=CreateGMap(this,"large"),google.maps.DownloadUrl("/scripts/src/app/ui/map/google/LocationList.json.aspx",function(t){ProcessJson(t),e&&ShowOnly(e),ShowRedZone(globalMap)})}),mapLoaded=!0},_resizeMap:function(){var e=FindMap();e&&e.checkResize()}}}),define("app/ui/map/google/controller",["jquery","easing","pubsub","app/ui/map/google/gmap"],function(e,t,n,r){var i,s,o;return{init:function(t){i=this,s=e(".g-map-container"),s.data("showOneCategory",""),o=e(".js-map-toggle"),r.init(),this._initEvents(),this._initSubscriptions(),this._showMap(t)},_initEvents:function(){e(window).on("resize",e.throttle(250,this._adjustMapSize))},_initSubscriptions:function(){e.subscribe("/googlemap/toggle",e.proxy(this._processSlideEvent,this)),e.subscribe("/googlemap/show-on-map",this._showOnMap),e.subscribe("/googlemap/resize-container",this._adjustMapSize)},_showMap:function(e){i._adjustMapSize(s),i._toggleSlide(e)},_processSlideEvent:function(t){var n=t.ref;if(s.is(":visible")&&n!==0){e.publish("/googlemap/toggle-complete",{ref:n});return}this._toggleSlide(n)},_toggleSlide:function(e){s.slideToggle(500,function(){i._setTabState(e)}),(o.text().indexOf("Open")>-1||o.text().indexOf("Loading")>-1)&&i._scrollToMap()},_setTabState:function(t){s.is(":visible")?(o.parent().removeClass("closed").addClass("open"),o.find(".map-button-label").text("Close Google Map"),e.publish("/googlemap/toggle-complete",{ref:t})):(o.parent().removeClass("open").addClass("closed"),o.find(".map-button-label").text("Open Google Map"))},_scrollToMap:function(){s.is(":visible")&&e("html,body").animate({scrollTop:e("#js-nav-primary").scrollTop()},1e3,"easeInOutExpo",function(){e("html").scrollTop()!==0&&e("html,body").animate({scrollTop:e("#js-nav-primary").scrollTop()},1e3,"easeInOutExpo")})},_showOnMap:function(t){t.preventDefault();var n=e(this).data("id");s.slideDown(900,function(){r.showOnly(n),i._setTabState(n)})},_adjustMapSize:function(){var t=s,n=e(window).width();n-=t.offset().left,n+="px",n&&t.width(n);var r=400;r+="px",r&&t.height(r),e.publish("/googlemap/resize-map")}}});